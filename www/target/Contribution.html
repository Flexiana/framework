<p><img src="resources/images/Xiana.png" width="242"></p><h1 id="contribution">Contribution</h1><ul><li><a href='#ticket_system'>Ticket system</a></li><li><a href='#coding_standards'>Coding standards</a></li><li><a href='#submitting_a_pr'>Submitting a PR</a></li><li><a href='#development_dependencies'>Development dependencies</a></li><li><a href='#setup'>Setup</a></li><li><a href='#deps'>Deps</a></li><li><a href='#releasing'>Releasing</a></li><li><a href='#generating_api_docs'>Generating API docs</a></li></ul><h2 id="ticket&#95;system">Ticket system</h2><p>We're using GitHub <a href='https://github.com/Flexiana/framework/issues'>issues</a> for tracking and discussing ideas and requests.</p><h2 id="coding&#95;standards">Coding standards</h2><p>Please follow <code>clj-style</code> and <code>kondo</code> instructions. <code>Kibit</code> isn't a showstopper, but PRs are more welcomed if not breaking <code>kibit</code>.</p><h2 id="submitting&#95;a&#95;pr">Submitting a PR</h2><p>Before you are submitting a PR be sure:</p><ul><li>You've updated the documentation and the <a href='../CHANGELOG.md'>CHANGELOG</a></li><li>the PR has an issue in GitHub, with a good description</li><li>you have added tests</li><li>you provided an example project for a new feature</li><li>All PRs need at least two approvals</li><li>Follow <a href='https://semver.org/#semantic-versioning-200'>Semantic Versioning 2.0.0</a></li></ul><h2 id="development&#95;dependencies">Development dependencies</h2><h3 id="mandatory">Mandatory</h3><ul><li>Clojure 1.10</li><li>Postgresql >= 11.5</li><li>Clojure cli >= 1.11.1.1155</li><li>Docker >= 19.03.11</li><li>Docker-compose >= 1.21.0</li></ul><h3 id="libraries">Libraries</h3><h4 id="mandatory">Mandatory</h4><table><thead><tr><th>Name</th><th>Version</th><th>Related</th></tr></thead><tbody><tr><td>funcool/cuerdas</td><td>RELEASE</td><td>String manipulation</td></tr><tr><td>metosin/reitit</td><td>0.5.12</td><td>Routes</td></tr><tr><td>potemkin/potemkin</td><td>0.4.5</td><td>Helper</td></tr><tr><td>com.draines/postal</td><td>2.0.4</td><td>Email</td></tr><tr><td>duct/server.http.jetty</td><td>0.2.1</td><td>WebServer</td></tr><tr><td>seancorfield/next.jdbc</td><td>1.1.613</td><td>WebServer</td></tr><tr><td>honeysql/honeysql</td><td>1.0.444</td><td>PostGreSQL</td></tr><tr><td>nilenso/honeysql-postgres</td><td>0.2.6</td><td>PostGreSQL</td></tr><tr><td>org.postgresql/postgresql</td><td>42.2.2</td><td>PostGreSQL</td></tr><tr><td>crypto-password/crypto-password</td><td>0.2.1</td><td>Security</td></tr><tr><td>clj-kondo/clj-kondo</td><td>RELEASE</td><td>Tests</td></tr><tr><td>npx</td><td>RELEASE</td><td>Documentation</td></tr></tbody></table><h2 id="setup">Setup</h2><pre><code class="shell">$ git clone git@github.com:Flexiana/framework.git; cd framework
$ ./script/auto.sh -y all
</code></pre><p>The first command will clone <code>Flexiana/framework</code> repository and jump to its directory. The second command calls <code>auto.sh</code> script to perform the following sequence of steps:</p><ol><li>Download the necessary docker images</li><li>Instantiate the database container</li><li>Import the initial SQL schema: <code>./docker/sql-scripts/init.sql</code></li><li>Populate the new schema with 'fake' data from: <code>./docker/sql-scripts/test.sql</code></li><li>Call <code>clj -X:test</code> that will download the necessary <em>Clojure</em>   dependencies and executes unitary tests.</li></ol><p>See <code>./script/auto.sh help</code> for more advanced options.</p><p>Remember it's necessary to have <code>docker</code> & <code>docker-compose</code> installed in your host machine. Docker daemon should be running. The chain of commands fails otherwise. It should also be noted that after the first installation everything will be cached preventing unnecessary rework, it's possible to run only the tests, if your development environment is already up, increasing the overall productivity.</p><pre><code class="shell">./script/auto.sh -y tests
</code></pre><h2 id="releasing">Releasing</h2><h3 id="install&#95;locally">Install locally</h3><pre><code class="shell">clj -M:install
</code></pre><h3 id="deploying&#95;a&#95;release">Deploying a release</h3><ul><li>Set up a new version number in <code>release.edn</code> eg: <code>&quot;0.5.0-rc2&quot;</code></li><li>Make a git TAG with <code>v</code> prefix, like <code>v0.5.0-rc2</code></li><li>Push it and wait for deployment to clojars</li></ul><h2 id="executing&#95;example's&#95;tests">Executing example's tests</h2><ul><li>Be sure all examples has the same framework version as it is in <code>release.edn</code> as dependency</li><li>Execute <code>./example-tests.sh</code> script. It will install the actual version of xiana, and go through the examples folder  for <code>check-style</code> and <code>lein test</code>.</li></ul><h2 id="generating&#95;api&#95;docs">Generating API Docs</h2><p>This is done with using <a href='https://github.com/mermaid-js/mermaid-cli'>mermaid-cli</a> and a forked version of <a href='https://github.com/Flexiana/codox'>Codox</a>.</p><p>We're using mermaid-cli for render UML-diagrams in markdown files, see the <code>doc/conventions&#95;template.md</code> for example. These files need to be added to the <code>/script/build-docs.sh</code> . For using it you need to have <code>npx</code>.</p><p>Codox is forked because markdown anchors aren't converted to HTML anchors in the official release. For use, you need to</p><pre><code class="shell">git clone git@github.com:Flexiana/codox.git
cd codox/codox
lein install
</code></pre><p>it before generating the documentation.</p><p>To generate or update the current version run the script:</p><pre><code class="shell">./script/build-docs.sh
</code></pre><p>This runs the following:</p><pre><code class="shell">npx -py @mermaid-js/mermaid-cli mmdc -i doc/conventions&#95;template.md -o doc/conventions.md
clj -X:codox
mv docs/new docs/{{version-number}}
</code></pre><p>It also updates the index.html file to point to the new version.</p>